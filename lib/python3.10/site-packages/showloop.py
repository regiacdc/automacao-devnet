import paramiko
import re

# Lista de direcciones IP de los switches Cisco
switches = ["192.168.1.128", "192.168.1.127", "192.168.1.130", "192.168.1.154", "192.168.1.155", "192.168.1.156", "192.168.1.157"]

# Credenciales de acceso SSH
username = "cisco"
password = "cisco"

def get_loopback_interfaces(ip, username, password):
    ssh_client = paramiko.SSHClient()
    ssh_client.set_missing_host_key_policy(paramiko.AutoAddPolicy())

    try:
        ssh_client.connect(ip, username=username, password=password, timeout=10)
        stdin, stdout, stderr = ssh_client.exec_command("show ip interface brief | include Loopback")
        output = stdout.read().decode('utf-8')

        # Analizar la salida para extraer información de las interfaces Loopback
        loopback_interfaces = re.findall(r'Loopback\d+', output)

        return loopback_interfaces

    except paramiko.AuthenticationException:
        print(f"Error de autenticación en {ip}")
    except paramiko.SSHException as e:
        print(f"Error de conexión SSH en {ip}: {str(e)}")
    except Exception as e:
        print(f"Error inesperado en {ip}: {str(e)}")
    finally:
        ssh_client.close()

for switch_ip in switches:
    print(f"Interfaces Loopback en {switch_ip}:")
    loopback_interfaces = get_loopback_interfaces(switch_ip, username, password)
    
    if loopback_interfaces:
        for interface in loopback_interfaces:
            print(interface)
    else:
        print("No se encontraron interfaces Loopback en este switch.")